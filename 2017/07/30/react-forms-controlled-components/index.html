<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Rèven,pobusama@gmail.com"><title>翻译 | 玩转 React 表单 —— 受控组件详解 · COOK LIFE</title><meta name="description" content="本文涵盖以下受控组件：

文本输入框
数字输入框
单选框
复选框
文本域
下拉选择框

同时也包含:

表单数据的清除和重置
表单数据的提交
表单校验


点击这里直接查看示例代码。查看示例。请在运行示例时打开浏览器的控制台。    

介绍在学习 React.js 时我遇到了一个问题，那就是很难找"><meta name="keywords" content="Hexo,HTML,CSS,Linux,Javascript"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">COOK LIFE</a></h3><div class="description"><p>把思想炖在生活里，小点火侯</p></div></div></div><ul class="social-links"><li><a href="http://weibo.com/pobusama"><i class="fa fa-weibo"></i></a></li><li><a href="http://github.com/pobusama"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="http://obhagvjtl.bkt.clouddn.com/person-icon2.jpg"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>翻译 | 玩转 React 表单 —— 受控组件详解</a></h3></div><div class="post-content"><p>本文涵盖以下受控组件：</p>
<ul>
<li>文本输入框</li>
<li>数字输入框</li>
<li>单选框</li>
<li>复选框</li>
<li>文本域</li>
<li>下拉选择框</li>
</ul>
<p>同时也包含:</p>
<ul>
<li>表单数据的清除和重置</li>
<li>表单数据的提交</li>
<li>表单校验</li>
</ul>
<blockquote>
<p><a href="https://github.com/lorenseanstewart/react-controlled-form-components" target="_blank" rel="noopener">点击这里</a>直接查看示例代码。<br><a href="http://lorenstewart.me/react-controlled-form-components/" target="_blank" rel="noopener">查看示例</a>。<br><strong>请在运行示例时打开浏览器的控制台。</strong>    </p>
</blockquote>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>在学习 <a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React.js</a> 时我遇到了一个问题，那就是很难找到受控组件的真实示例。受控文本输入框的例子倒是很丰富，但复选框、单选框、下拉选择框的例子却不尽人意。</p>
<p>本文列举了真实的受控表单组件示例，要是我在学习 React 的时候早点发现这些示例就好了。除了日期和时间输入框需要另开篇幅详细讨论，文中列举了所有的表单元素。</p>
<p>有时候，为了减少开发时间，有时候人们很容易为了一些东西（譬如表单元素）引入一个库。而对于表单，我发现当需要添加自定义行为或表单校验时，使用库会让事情变得更复杂。不过一旦掌握合适的 React 模式，你会发现构建表单组件并非难事，并且有些东西完全可以自己动手，丰衣足食。请把本文的示例代码当作你创建表单组件的起点或灵感之源。</p>
<p>除了提供单独的组件代码，我还将这些组件放进表单中，方便你理解子组件如何更新父组件 state ，以及接下来父组件如何通过 props（单向数据流）更新子组件。</p>
<p><strong>注意</strong>：本<a href="http://lorenstewart.me/react-controlled-form-components/" target="_blank" rel="noopener">表单示例</a>由很赞的 <a href="https://github.com/facebookincubator/create-react-app" target="_blank" rel="noopener">create-react-app</a> 构建配置生成，如果你还没有安装该构建配置，我强烈推荐你安装一下（<code>npm install -g create-react-app</code>）。目前这是搭建 React 应用最简单的方式。</p>
<h2 id="什么是受控组件"><a href="#什么是受控组件" class="headerlink" title="什么是受控组件?"></a>什么是受控组件?</h2><p>受控组件有两个特点:</p>
<ol>
<li>受控组件提供方法，让我们在每次 <code>onChange</code> 事件发生时控制它们的数据，而不是一次性地获取表单数据（例如用户点提交按钮时）。“被控制“ 的表单数据保存在 state 中（在本文示例中，是父组件或容器组件的 state）。<br>(译注：这里作者的意思是通过受控组件， 可以跟踪用户操作表单时的数据，从而更新容器组件的 state ，再单向渲染表单元素 UI。如果不使用受控组件，在用户实时操作表单时，比如在输入框输入文本时，不会同步到容器组件的 state，虽然能同步输入框本身的 value，但与容器组件的 state 无关，因此容器组件只能在某一时间，比如提表单时一次性地拿到（通过 refs 或者选择器）表单数据，而难以跟踪）</li>
<li>受控组件的展示数据是其父组件通过 props 传递下来的。</li>
</ol>
<p>这个单向循环 —— （数据）从（1）子组件输入到（2）父组件的 state，接着（3）通过 props 回到子组件，就是 React.js 应用架构中单向数据流的含义。</p>
<h2 id="表单结构"><a href="#表单结构" class="headerlink" title="表单结构"></a>表单结构</h2><p>我们的顶级组件叫做 <code>App</code>，这是它的代码：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;  </span><br><span class="line"><span class="keyword">import</span> <span class="string">'../node_modules/spectre.css/dist/spectre.min.css'</span>;  </span><br><span class="line"><span class="keyword">import</span> <span class="string">'./styles.css'</span>;  </span><br><span class="line"><span class="keyword">import</span> FormContainer <span class="keyword">from</span> <span class="string">'./containers/FormContainer'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;  </span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=<span class="string">"container"</span>&gt;</span><br><span class="line">        &lt;div className=<span class="string">"columns"</span>&gt;</span><br><span class="line">          &lt;div className=<span class="string">"col-md-9 centered"</span>&gt;</span><br><span class="line">            &lt;h3&gt;React.js Controlled Form Components&lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">            &lt;FormContainer /</span>&gt;</span><br><span class="line">          &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>
<p><code>App</code> 只负责渲染 <code>index.html</code> 页面。整个 <code>App</code> 组件最有趣的部分是 13 行，<code>FormContainer</code> 组件。</p>
<h2 id="插曲-容器（智能）组件-VS-普通（木偶）组件"><a href="#插曲-容器（智能）组件-VS-普通（木偶）组件" class="headerlink" title="插曲: 容器（智能）组件 VS 普通（木偶）组件"></a>插曲: 容器（智能）组件 VS 普通（木偶）组件</h2><p>是时候提及一下容器（智能）组件和普通（木偶）组件了。容器组件包含业务逻辑，它会发起数据请求或进行其他业务操作。普通组件则从它的父（容器）组件接收数据。木偶组件有可能触发更新 state （译注：容器组件的 state）这类逻辑行为，但它仅通过从父（容器）组件传入的方法来达到该目的。</p>
<p><strong>注意：</strong> 虽然在我们的表单应用里父组件就是容器组件，但我要强调，并非所有的父组件都是容器组件。木偶组件嵌套木偶组件也是可以的。</p>
<h2 id="回到应用结构"><a href="#回到应用结构" class="headerlink" title="回到应用结构"></a>回到应用结构</h2><p><code>FormContainer</code> 组件包含了表单元素组件，它在生命周期钩子方法 <code>componentDidMount</code> 里请求数据，此外还包含更新表单应用 state 的逻辑行为。在下面的预览代码里，我移除了表单元素的 props 和 change 事件处理方法，这样看起来更简洁清晰（拉到文章底部，可以看到完整代码）。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;  </span><br><span class="line"><span class="keyword">import</span> CheckboxOrRadioGroup <span class="keyword">from</span> <span class="string">'../components/CheckboxOrRadioGroup'</span>;  </span><br><span class="line"><span class="keyword">import</span> SingleInput <span class="keyword">from</span> <span class="string">'../components/SingleInput'</span>;  </span><br><span class="line"><span class="keyword">import</span> TextArea <span class="keyword">from</span> <span class="string">'../components/TextArea'</span>;  </span><br><span class="line"><span class="keyword">import</span> Select <span class="keyword">from</span> <span class="string">'../components/Select'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FormContainer</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;  </span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.handleFormSubmit = <span class="keyword">this</span>.handleFormSubmit.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.handleClearForm = <span class="keyword">this</span>.handleClearForm.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    fetch(<span class="string">'./fake_db.json'</span>)</span><br><span class="line">      .then(<span class="function"><span class="params">res</span> =&gt;</span> res.json())</span><br><span class="line">      .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">          ownerName: data.ownerName,</span><br><span class="line">          petSelections: data.petSelections,</span><br><span class="line">          selectedPets: data.selectedPets,</span><br><span class="line">          ageOptions: data.ageOptions,</span><br><span class="line">          ownerAgeRangeSelection: data.ownerAgeRangeSelection,</span><br><span class="line">          siblingOptions: data.siblingOptions,</span><br><span class="line">          siblingSelection: data.siblingSelection,</span><br><span class="line">          currentPetCount: data.currentPetCount,</span><br><span class="line">          description: data.description</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  handleFormSubmit() &#123;</span><br><span class="line">    <span class="comment">// 提交逻辑写在这</span></span><br><span class="line">  &#125;</span><br><span class="line">  handleClearForm() &#123;</span><br><span class="line">    <span class="comment">// 清除表单逻辑写在这</span></span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;form className=<span class="string">"container"</span> onSubmit=&#123;<span class="keyword">this</span>.handleFormSubmit&#125;&gt;</span><br><span class="line">        &lt;h5&gt;Pet Adoption Form&lt;<span class="regexp">/h5&gt;</span></span><br><span class="line"><span class="regexp">        &lt;SingleInput /</span>&gt; &#123;<span class="comment">/* Full name text input */</span>&#125;</span><br><span class="line">        &lt;Select /&gt; &#123;<span class="comment">/* Owner age range select */</span>&#125;</span><br><span class="line">        &lt;CheckboxOrRadioGroup /&gt; &#123;<span class="comment">/* Pet type checkboxes */</span>&#125;</span><br><span class="line">        &lt;CheckboxOrRadioGroup /&gt; &#123;<span class="comment">/* Will you adopt siblings? radios */</span>&#125;</span><br><span class="line">        &lt;SingleInput /&gt; &#123;<span class="comment">/* Number of current pets number input */</span>&#125;</span><br><span class="line">        &lt;TextArea /&gt; &#123;<span class="comment">/* Descriptions of current pets textarea */</span>&#125;</span><br><span class="line">        &lt;input</span><br><span class="line">          type=<span class="string">"submit"</span></span><br><span class="line">          className=<span class="string">"btn btn-primary float-right"</span></span><br><span class="line">          value=<span class="string">"Submit"</span>/&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          className=<span class="string">"btn btn-link float-left"</span></span><br><span class="line">          onClick=&#123;<span class="keyword">this</span>.handleClearForm&#125;&gt;Clear form&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>form&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们勾勒出了应用基础结构，接下来我们一起浏览下每个子组件的细节。</p>
<h2 id="lt-SingleInput-gt-组件"><a href="#lt-SingleInput-gt-组件" class="headerlink" title="&lt;SingleInput /&gt; 组件"></a><code>&lt;SingleInput /&gt;</code> 组件</h2><p>该组件可以是 <code>text</code> 或 <code>number</code> 输入框，这取决于传入的 props。通过 React 的 PropTypes，我们可以非常好地记录组件拿到的 props。如果漏传 props 或传入错误的数据类型, 浏览器的控制台中会出现警告信息。</p>
<p>下面列举 <code>&lt;SingleInput /&gt;</code> 组件的 PropTypes：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SingleInput.propTypes = &#123;  </span><br><span class="line">  inputType: React.PropTypes.oneOf([<span class="string">'text'</span>, <span class="string">'number'</span>]).isRequired,</span><br><span class="line">  title: React.PropTypes.string.isRequired,</span><br><span class="line">  name: React.PropTypes.string.isRequired,</span><br><span class="line">  controlFunc: React.PropTypes.func.isRequired,</span><br><span class="line">  content: React.PropTypes.oneOfType([</span><br><span class="line">    React.PropTypes.string,</span><br><span class="line">    React.PropTypes.number,</span><br><span class="line">  ]).isRequired,</span><br><span class="line">  placeholder: React.PropTypes.string,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>PropTypes 声明了 prop 的类型（string、 number、 array、 object 等等），其中包括了必需（<code>isRequired</code>）和非必需的 prop，当然它还有更多的用途（欲知更多细节，请查看 <a href="https://facebook.github.io/react/docs/typechecking-with-proptypes.html" target="_blank" rel="noopener">React 文档</a>）。</p>
<p>下面我们逐个讨论这些 PropType：</p>
<ol>
<li><code>inputType</code>：接收两个字符串：<code>&#39;text&#39;</code> 或 <code>&#39;number&#39;</code>。该设置指定渲染 <code>&lt;input type=&quot;text&quot; /&gt;</code> 组件或 <code>&lt;input type=&quot;number&quot; /&gt;</code> 组件。</li>
<li><code>title</code>：接收一个字符串，我们将它渲染到输入框的 label 元素中。</li>
<li><code>name</code>：输入框的 name 属性。</li>
<li><code>controlFunc</code>：它是从父组件或容器组件传下来的方法。因为该方法挂载在 React 的 onChange 处理方法上，所以每当输入框的输入值改变时，该方法都会被执行，从而更新父组件或容器组件的 state。</li>
<li><code>content</code>：输入框内容。受控输入框只会显示通过 props 传入的数据。</li>
<li><code>placeholder</code>：输入框的占位符文本，是一个字符串。</li>
</ol>
<p>既然该组件不需要任何逻辑行为和内部 state，那我们可以将它写成纯函数组件（pure functional component）。我们将纯函数组件赋值给一个 <code>const</code> 常量上。下面是 <code>&lt;SingleInput /&gt;</code> 组件的所有代码。本文列举的所有表单元素组件都是纯函数组件。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> SingleInput = <span class="function">(<span class="params">props</span>) =&gt;</span> (  </span><br><span class="line">  &lt;div className=<span class="string">"form-group"</span>&gt;</span><br><span class="line">    &lt;label className=<span class="string">"form-label"</span>&gt;&#123;props.title&#125;&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">    &lt;input</span></span><br><span class="line"><span class="regexp">      className="form-input"</span></span><br><span class="line"><span class="regexp">      name=&#123;props.name&#125;</span></span><br><span class="line"><span class="regexp">      type=&#123;props.inputType&#125;</span></span><br><span class="line"><span class="regexp">      value=&#123;props.content&#125;</span></span><br><span class="line"><span class="regexp">      onChange=&#123;props.controlFunc&#125;</span></span><br><span class="line"><span class="regexp">      placeholder=&#123;props.placeholder&#125; /</span>&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">SingleInput.propTypes = &#123;  </span></span><br><span class="line"><span class="regexp">  inputType: React.PropTypes.oneOf(['text', 'number']).isRequired,</span></span><br><span class="line"><span class="regexp">  title: React.PropTypes.string.isRequired,</span></span><br><span class="line"><span class="regexp">  name: React.PropTypes.string.isRequired,</span></span><br><span class="line"><span class="regexp">  controlFunc: React.PropTypes.func.isRequired,</span></span><br><span class="line"><span class="regexp">  content: React.PropTypes.oneOfType([</span></span><br><span class="line"><span class="regexp">    React.PropTypes.string,</span></span><br><span class="line"><span class="regexp">    React.PropTypes.number,</span></span><br><span class="line"><span class="regexp">  ]).isRequired,</span></span><br><span class="line"><span class="regexp">  placeholder: React.PropTypes.string,</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default SingleInput;</span></span><br></pre></td></tr></table></figure>
<p>接着，我们用 <code>handleFullNameChange</code> 方法（它被传入到 <code>controlFunc</code> prop 属性）来更新 <code>&lt;FormContainer /&gt;</code> 容器组件的 state。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// FormContainer.js</span></span><br><span class="line"></span><br><span class="line">handleFullNameChange(e) &#123;  </span><br><span class="line">  <span class="keyword">this</span>.setState(&#123; <span class="attr">ownerName</span>: e.target.value &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// constructor 方法里别漏掉了这行:</span></span><br><span class="line"><span class="comment">// this.handleFullNameChange = this.handleFullNameChange.bind(this);</span></span><br></pre></td></tr></table></figure>
<p>随后我们将容器组件更新后的 state （译注：这里指 state 上挂载的 ownerName 属性）通过 <code>content</code> prop 传回 <code>&lt;SingleInput /&gt;</code> 组件。</p>
<h2 id="lt-Select-gt-组件"><a href="#lt-Select-gt-组件" class="headerlink" title="&lt;Select /&gt; 组件"></a><code>&lt;Select /&gt;</code> 组件</h2><p>选择组件（就是下拉选择组件），接收以下 props：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Select.propTypes = &#123;  </span><br><span class="line">  name: React.PropTypes.string.isRequired,</span><br><span class="line">  options: React.PropTypes.array.isRequired,</span><br><span class="line">  selectedOption: React.PropTypes.string,</span><br><span class="line">  controlFunc: React.PropTypes.func.isRequired,</span><br><span class="line">  placeholder: React.PropTypes.string</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ol>
<li><code>name</code>：填充表单元素上 <code>name</code> 属性的字符串变量。</li>
<li><code>options</code>：是一个数组（本例是字符串数组）。通过在组件的 render 方法中使用 <code>props.options.map()</code>， 该数组中的每一项都会被渲染成一个选择项。</li>
<li><code>selectedOption</code>：用以显示表单填充的默认选项，或用户已选择的选项（例如当用户编辑之前已提交过的表单数据时，可以使用这个 prop）。</li>
<li><code>controlFunc</code>：它是从父组件或容器组件传下来的方法。因为该方法挂载在 React 的 onChange 处理方法上，所以每当改变选择框组件的值时，该方法都会被执行，从而更新父组件或容器组件的 state。</li>
<li><code>placeholder</code>：作为占位文本的字符串，用来填充第一个 <code>&lt;option&gt;</code> 标签。本组件中，我们将第一个选项的值设置成空字符串（参看下面代码的第 10 行）。</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Select = <span class="function">(<span class="params">props</span>) =&gt;</span> (  </span><br><span class="line">  &lt;div className=<span class="string">"form-group"</span>&gt;</span><br><span class="line">    &lt;select</span><br><span class="line">      name=&#123;props.name&#125;</span><br><span class="line">      value=&#123;props.selectedOption&#125;</span><br><span class="line">      onChange=&#123;props.controlFunc&#125;</span><br><span class="line">      className=<span class="string">"form-select"</span>&gt;</span><br><span class="line">      &lt;option value=<span class="string">""</span>&gt;&#123;props.placeholder&#125;&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">      &#123;props.options.map(opt =&gt; &#123;</span></span><br><span class="line"><span class="regexp">        return (</span></span><br><span class="line"><span class="regexp">          &lt;option</span></span><br><span class="line"><span class="regexp">            key=&#123;opt&#125;</span></span><br><span class="line"><span class="regexp">            value=&#123;opt&#125;&gt;&#123;opt&#125;&lt;/</span>option&gt;</span><br><span class="line">        );</span><br><span class="line">      &#125;)&#125;</span><br><span class="line">    &lt;<span class="regexp">/select&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">Select.propTypes = &#123;  </span><br><span class="line">  name: React.PropTypes.string.isRequired,</span><br><span class="line">  options: React.PropTypes.array.isRequired,</span><br><span class="line">  selectedOption: React.PropTypes.string,</span><br><span class="line">  controlFunc: React.PropTypes.func.isRequired,</span><br><span class="line">  placeholder: React.PropTypes.string</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Select;</span><br></pre></td></tr></table></figure>
<p>请注意 option 标签中的 <code>key</code> 属性（第 14 行）。React 要求被重复操作渲染的每个元素必须拥有独一无二的 <code>key</code> 值，我们这里的 <code>.map()</code> 方法就是所谓的重复操作。既然选择项数组中的每个元素是独有的，我们就把它们当成 <code>key</code> prop。该 <code>key</code> 值协助 React 追踪 DOM 变化。虽然在循环操作或 mapping 时忘加 <code>key</code> 属性不会中断应用，但是浏览器的控制台里会出现警告，并且渲染性能将受到影响。</p>
<p>以下是控制选择框组件（记住，该组件存在于 <code>&lt;FormContainer /&gt;</code> 组件中）的处理方法（该方法从 <code>&lt;FormContainer /&gt;</code> 组件传入到子组件的 <code>controlFun</code> prop 中）</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// FormContainer.js</span></span><br><span class="line"></span><br><span class="line">handleAgeRangeSelect(e) &#123;  </span><br><span class="line">  <span class="keyword">this</span>.setState(&#123; <span class="attr">ownerAgeRangeSelection</span>: e.target.value &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// constructor 方法里别漏掉了这行:</span></span><br><span class="line"><span class="comment">// this.handleAgeRangeSelect = this.handleAgeRangeSelect.bind(this);</span></span><br></pre></td></tr></table></figure>
<h2 id="lt-CheckboxOrRadioGroup-gt-组件"><a href="#lt-CheckboxOrRadioGroup-gt-组件" class="headerlink" title="&lt;CheckboxOrRadioGroup /&gt; 组件"></a><code>&lt;CheckboxOrRadioGroup /&gt;</code> 组件</h2><p><code>&lt;CheckboxOrRadioGroup /&gt;</code> 与众不同， 它从 props 拿到传入的数组（像此前 <code>&lt;Select /&gt;</code> 组件的选项数组一样），通过遍历数组来渲染一组表单元素的集合 —— 可以是复选框集合或单选框集合。</p>
<p>让我们深入 PropTypes 来更好地理解 <code>&lt;CheckboxOrRadioGroup /&gt;</code> 组件。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CheckboxGroup.propTypes = &#123;  </span><br><span class="line">  title: React.PropTypes.string.isRequired,</span><br><span class="line">  type: React.PropTypes.oneOf([<span class="string">'checkbox'</span>, <span class="string">'radio'</span>]).isRequired,</span><br><span class="line">  setName: React.PropTypes.string.isRequired,</span><br><span class="line">  options: React.PropTypes.array.isRequired,</span><br><span class="line">  selectedOptions: React.PropTypes.array,</span><br><span class="line">  controlFunc: React.PropTypes.func.isRequired</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ol>
<li><code>title</code>：一个字符串，用以填充单选或复选框集合的 label 标签内容。</li>
<li><code>type</code>：接收 <code>&#39;checkbox&#39;</code> 或 <code>&#39;radio&#39;</code> 两种配置的一种，并用指定的配置渲染输入框（译注：这里指复选输入框或单选输入框）。</li>
<li><code>setName</code>：一个字符串，用以填充每个单选或复选框的 <code>name</code> 属性值。</li>
<li><code>options</code>：一个由字符串元素组成的数组，数组元素用以渲染每个单选框或复选框的值和 label 的内容。例如，<code>[&#39;dog&#39;, &#39;cat&#39;, &#39;pony&#39;]</code> 数组中的元素将会渲染三个单选框或复选框。</li>
<li><code>selectedOptions</code>：一个由字符串元素组成的数组，用来表示预选项。在示例 4 中，如果 <code>selectedOptions</code> 数组包含 <code>&#39;dog&#39;</code> 和 <code>&#39;pony&#39;</code> 元素，那么相应的两个选项会被渲染成选中状态，而 <code>&#39;cat&#39;</code> 选项则被渲染成未选中状态。当用户提交表单时，该数组将会是用户的选择数据。</li>
<li><code>controlFunc</code>：一个方法，用来处理从 <code>selectedOptions</code> 数组 prop 中添加或删除字符串的操作。</li>
</ol>
<p>这是本表单应用中最有趣的组件，让我们来看一下：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> CheckboxOrRadioGroup = <span class="function">(<span class="params">props</span>) =&gt;</span> (  </span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;label className=<span class="string">"form-label"</span>&gt;&#123;props.title&#125;&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">    &lt;div className="checkbox-group"&gt;</span></span><br><span class="line"><span class="regexp">      &#123;props.options.map(opt =&gt; &#123;</span></span><br><span class="line"><span class="regexp">        return (</span></span><br><span class="line"><span class="regexp">          &lt;label key=&#123;opt&#125; className="form-label capitalize"&gt;</span></span><br><span class="line"><span class="regexp">            &lt;input</span></span><br><span class="line"><span class="regexp">              className="form-checkbox"</span></span><br><span class="line"><span class="regexp">              name=&#123;props.setName&#125;</span></span><br><span class="line"><span class="regexp">              onChange=&#123;props.controlFunc&#125;</span></span><br><span class="line"><span class="regexp">              value=&#123;opt&#125;</span></span><br><span class="line"><span class="regexp">              checked=&#123; props.selectedOptions.indexOf(opt) &gt; -1 &#125;</span></span><br><span class="line"><span class="regexp">              type=&#123;props.type&#125; /</span>&gt; &#123;opt&#125;</span><br><span class="line">          &lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">      &#125;)&#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">CheckboxOrRadioGroup.propTypes = &#123;  </span></span><br><span class="line"><span class="regexp">  title: React.PropTypes.string.isRequired,</span></span><br><span class="line"><span class="regexp">  type: React.PropTypes.oneOf(['checkbox', 'radio']).isRequired,</span></span><br><span class="line"><span class="regexp">  setName: React.PropTypes.string.isRequired,</span></span><br><span class="line"><span class="regexp">  options: React.PropTypes.array.isRequired,</span></span><br><span class="line"><span class="regexp">  selectedOptions: React.PropTypes.array,</span></span><br><span class="line"><span class="regexp">  controlFunc: React.PropTypes.func.isRequired</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default CheckboxOrRadioGroup;</span></span><br></pre></td></tr></table></figure>
<p><code>checked={ props.selectedOptions.indexOf(option) &gt; -1 }</code> 这一行代码表示单选框或复选框是否被选中的逻辑。</p>
<p>属性 <code>checked</code> 接收一个布尔值，用来表示 input 组件是否应该被渲染成选中状态。我们在检查到 input 的值是否是 <code>props.selectedOptions</code> 数组的元素之一时生成该布尔值。<br><code>myArray.indexOf(item)</code> 方法返回 item 在数组中的索引值。如果 item 不在数组中，返回 <code>-1</code>，因此，我们写了 <code>&gt; -1</code>。</p>
<p>注意，<code>0</code> 是一个合法的索引值，所以我们需要 <code>&gt; -1</code> ，否则代码会有 bug。如果没有 <code>&gt; -1</code>，<code>selectedOptions</code> 数组中的第一个 item —— 其索引为 0 —— 将永远不会被渲染成选中状态，因为 <code>0</code> 是一个类 <code>false</code> 的值（译注：在 <code>checked</code> 属性中，<code>0</code> 会被当成 <code>false</code> 处理）。</p>
<p>本组件的处理方法同样比其他的有趣。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">handlePetSelection(e) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> newSelection = e.target.value;</span><br><span class="line">  <span class="keyword">let</span> newSelectionArray;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">this</span>.state.selectedPets.indexOf(newSelection) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">    newSelectionArray = <span class="keyword">this</span>.state.selectedPets.filter(<span class="function"><span class="params">s</span> =&gt;</span> s !== newSelection)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    newSelectionArray = [...this.state.selectedPets, newSelection];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">selectedPets</span>: newSelectionArray &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如同所有处理方法一样，事件对象被传入方法，这样一来我们就能拿到事件对象的值（译注：准确来说，应该是事件目标元素的值）。我们将该值赋给<code>newSelection</code> 常量。接着我们在函数顶部附近定义 <code>newSelectionArray</code> 变量。因为我们将在一个 <code>if/else</code> 代码块里对该变量进行赋值，所以用 <code>let</code> 而非 <code>const</code> 来定义它。我们在代码块外部进行定义，这样一来被定义变量的作用域就是函数内部的最外沿，并且函数内的代码块都能访问到外部定义的变量。</p>
<p>该方法需要处理两种可能的情况。</p>
<p>如果 input 组件的值<strong>不在</strong> <code>selectedOptions</code> 数组中，我们要将值添加进该数组。<br>如果 input 组件的值<strong>在</strong> <code>selectedOptions</code> 数组中，我们要从数组中删除该值。</p>
<p><code>添加（第 8 - 10 行）：</code> 为了将新值添加进选项数组，我们通过解构旧数组（数组前的三点<code>...</code>表示解构）创建一个新数组，并且将新值添加到数组的尾部 <code>newSelectionArray = [...this.state.selectedPets, newSelection];</code>。</p>
<p>注意，我们创建了一个新数组，而不是通过类似 <code>.push()</code> 的方法来改变原数组。不改变已存在的对象和数组，而是创建新的对象和数组，这在 React 中是又一个最佳实践。开发者这样做可以更容易地跟踪 state 的变化，而第三方 state 管理库，如 Redux 则可以做高性能的浅比较，而不是阻塞性能的深比较。</p>
<p>删除（第 6 - 8 行）：<code>if</code> 代码块借助此前用到的 <code>.indexOf()</code> 小技巧，检查选项是否在数组中。如果选项已经在数组中，通过<code>.filter()</code>方法，该选项将被移除。 该方法返回一个包含所有满足 filter 条件的元素的新数组（记住要避免在 React 直接修改数组或对象！）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">newSelectionArray = <span class="keyword">this</span>.state.selectedPets.filter(<span class="function"><span class="params">s</span> =&gt;</span> s !== newSelection)</span><br></pre></td></tr></table></figure>
<p>在这种情况下，除了传入到方法中的选项之外，其他选项都会被返回。</p>
<h2 id="lt-TextArea-gt-组件"><a href="#lt-TextArea-gt-组件" class="headerlink" title="&lt;TextArea /&gt; 组件"></a><code>&lt;TextArea /&gt;</code> 组件</h2><p><code>&lt;TextArea /&gt;</code> 和我们已提到的那些组件非常相似，除了 <code>resize</code> 和 <code>rows</code>，目前你应该对它的 props 很熟悉了。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">TextArea.propTypes = &#123;  </span><br><span class="line">  title: React.PropTypes.string.isRequired,</span><br><span class="line">  rows: React.PropTypes.number.isRequired,</span><br><span class="line">  name: React.PropTypes.string.isRequired,</span><br><span class="line">  content: React.PropTypes.string.isRequired,</span><br><span class="line">  resize: React.PropTypes.bool,</span><br><span class="line">  placeholder: React.PropTypes.string,</span><br><span class="line">  controlFunc: React.PropTypes.func.isRequired</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ol>
<li><code>title</code>：接收一个字符串，用以渲染文本域的 label 标签内容。</li>
<li><code>rows</code>：接收一个整数，用来指定文本域的行数。</li>
<li><code>name</code>：文本域的 name 属性。</li>
<li><code>content</code>：文本域的内容。受控组件只会显示通过 props 传入的数据。</li>
<li><code>resize</code>： 接受一个布尔值，用来指定文本域能否调整大小。</li>
<li><code>placeholder</code>：充当文本域占位文本的字符串。</li>
<li><code>controlFunc</code>： 它是从父组件或容器组件传下来的方法。因为该方法挂载在 React 的 onChange 处理方法上，所以每当改变选择框组件的值时，该方法都会被执行，从而更新父组件或容器组件的 state。</li>
</ol>
<p><code>&lt;TextArea /&gt;</code> 组件的完整代码：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> TextArea = <span class="function">(<span class="params">props</span>) =&gt;</span> (  </span><br><span class="line">  &lt;div className=<span class="string">"form-group"</span>&gt;</span><br><span class="line">    &lt;label className=<span class="string">"form-label"</span>&gt;&#123;props.title&#125;&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">    &lt;textarea</span></span><br><span class="line"><span class="regexp">      className="form-input"</span></span><br><span class="line"><span class="regexp">      style=&#123;props.resize ? null : &#123;resize: 'none'&#125;&#125;</span></span><br><span class="line"><span class="regexp">      name=&#123;props.name&#125;</span></span><br><span class="line"><span class="regexp">      rows=&#123;props.rows&#125;</span></span><br><span class="line"><span class="regexp">      value=&#123;props.content&#125;</span></span><br><span class="line"><span class="regexp">      onChange=&#123;props.controlFunc&#125;</span></span><br><span class="line"><span class="regexp">      placeholder=&#123;props.placeholder&#125; /</span>&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">TextArea.propTypes = &#123;  </span></span><br><span class="line"><span class="regexp">  title: React.PropTypes.string.isRequired,</span></span><br><span class="line"><span class="regexp">  rows: React.PropTypes.number.isRequired,</span></span><br><span class="line"><span class="regexp">  name: React.PropTypes.string.isRequired,</span></span><br><span class="line"><span class="regexp">  content: React.PropTypes.string.isRequired,</span></span><br><span class="line"><span class="regexp">  resize: React.PropTypes.bool,</span></span><br><span class="line"><span class="regexp">  placeholder: React.PropTypes.string,</span></span><br><span class="line"><span class="regexp">  controlFunc: React.PropTypes.func.isRequired</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default TextArea;</span></span><br></pre></td></tr></table></figure>
<p><code>&lt;TextAreas /&gt;</code> 组件的控制方法和 <code>&lt;SingleInput /&gt;</code> 如出一辙。细节部分请参考 <code>&lt;SingleInput /&gt;</code> 组件。</p>
<h2 id="表单操作"><a href="#表单操作" class="headerlink" title="表单操作"></a>表单操作</h2><p><code>handleClearForm</code> 和 <code>handleFormSubmit</code> 方法操作整个表单。</p>
<h4 id="1-handleClearForm"><a href="#1-handleClearForm" class="headerlink" title="1. handleClearForm"></a>1. handleClearForm</h4><p>既然我们在表单的各处都使用了单向数据流，那么清除表单数据对我们来说也是小菜一碟。<code>&lt;FormContainer /&gt;</code> 组件的 state 控制了每个表单元素的值。该容器的 state 通过 props 传入子组件。只有当 <code>&lt;FormContainer /&gt;</code> 组件的 state 改变时，表单组件显示的值才会改变。</p>
<p>清除表单子组件中显示的数据很简单，只要把容器的 state （译注：这里是指 state 对象上挂载的各个变量）设置成空数组和空字符串就可以了（如果有数字输入框的话则是将值设置成 <code>0</code>）。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">handleClearForm(e) &#123;  </span><br><span class="line">  e.preventDefault();</span><br><span class="line">  <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">    ownerName: <span class="string">''</span>,</span><br><span class="line">    selectedPets: [],</span><br><span class="line">    ownerAgeRangeSelection: <span class="string">''</span>,</span><br><span class="line">    siblingSelection: [],</span><br><span class="line">    currentPetCount: <span class="number">0</span>,</span><br><span class="line">    description: <span class="string">''</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意，<code>e.preventDefault()</code> 阻止了页面重新加载，接着 <code>setState()</code> 方法用来清除表单数据。</p>
<h4 id="2-handleFormSubmit"><a href="#2-handleFormSubmit" class="headerlink" title="2. handleFormSubmit"></a>2. handleFormSubmit</h4><p>为了提交表单数据，我们从 state 中抽取需要提交的属性值，创建了一个对象。接着使用 AJAX 库或技术将这些数据发送给 API（本文不包含此类内容）。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">handleFormSubmit(e) &#123;  </span><br><span class="line">  e.preventDefault();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> formPayload = &#123;</span><br><span class="line">    ownerName: <span class="keyword">this</span>.state.ownerName,</span><br><span class="line">    selectedPets: <span class="keyword">this</span>.state.selectedPets,</span><br><span class="line">    ownerAgeRangeSelection: <span class="keyword">this</span>.state.ownerAgeRangeSelection,</span><br><span class="line">    siblingSelection: <span class="keyword">this</span>.state.siblingSelection,</span><br><span class="line">    currentPetCount: <span class="keyword">this</span>.state.currentPetCount,</span><br><span class="line">    description: <span class="keyword">this</span>.state.description</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Send this in a POST request:'</span>, formPayload);</span><br><span class="line">  <span class="keyword">this</span>.handleClearForm(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>请注意我们在提交数据后执行 <code>this.handleClearForm(e)</code> 清除了表单。</p>
<h2 id="表单校验"><a href="#表单校验" class="headerlink" title="表单校验"></a>表单校验</h2><p>受控表单组件非常适合自定义表单校验。假设要从 <code>&lt;TextArea /&gt;</code> 组件中排除字母 “e”，可以这样做：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">handleDescriptionChange(e) &#123;  </span><br><span class="line">  <span class="keyword">const</span> textArray = e.target.value.split(<span class="string">''</span>).filter(<span class="function"><span class="params">x</span> =&gt;</span> x !== <span class="string">'e'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'string split into array of letters'</span>,textArray);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> filteredText = textArray.join(<span class="string">''</span>);</span><br><span class="line">  <span class="keyword">this</span>.setState(&#123; <span class="attr">description</span>: filteredText &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>把 <code>e.target.value</code> 字符串分割成字母数组，就生成了上述的 <code>textArray</code>。这样字母 “e” （或其他设法排除的字母）就被过滤掉了。再把剩余的字母组成的数组拼成字符串，最后用该新字符串去设置组件 state。还不错吧？</p>
<p>以上代码放在<a href="https://github.com/lorenseanstewart/react-controlled-form-components" target="_blank" rel="noopener">本文的仓库中</a>，但我将它们注释掉了，你可以按自己的需求自由地调整。</p>
<h2 id="lt-FormContainer-gt-组件"><a href="#lt-FormContainer-gt-组件" class="headerlink" title="&lt;FormContainer /&gt; 组件"></a><code>&lt;FormContainer /&gt;</code> 组件</h2><p>下面是我承诺给你们的 <code>&lt;FormContainer /&gt;</code> 组件完整代码，</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;  </span><br><span class="line"><span class="keyword">import</span> CheckboxOrRadioGroup <span class="keyword">from</span> <span class="string">'../components/CheckboxOrRadioGroup'</span>;  </span><br><span class="line"><span class="keyword">import</span> SingleInput <span class="keyword">from</span> <span class="string">'../components/SingleInput'</span>;  </span><br><span class="line"><span class="keyword">import</span> TextArea <span class="keyword">from</span> <span class="string">'../components/TextArea'</span>;  </span><br><span class="line"><span class="keyword">import</span> Select <span class="keyword">from</span> <span class="string">'../components/Select'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FormContainer</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;  </span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      ownerName: <span class="string">''</span>,</span><br><span class="line">      petSelections: [],</span><br><span class="line">      selectedPets: [],</span><br><span class="line">      ageOptions: [],</span><br><span class="line">      ownerAgeRangeSelection: <span class="string">''</span>,</span><br><span class="line">      siblingOptions: [],</span><br><span class="line">      siblingSelection: [],</span><br><span class="line">      currentPetCount: <span class="number">0</span>,</span><br><span class="line">      description: <span class="string">''</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">this</span>.handleFormSubmit = <span class="keyword">this</span>.handleFormSubmit.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.handleClearForm = <span class="keyword">this</span>.handleClearForm.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.handleFullNameChange = <span class="keyword">this</span>.handleFullNameChange.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.handleCurrentPetCountChange = <span class="keyword">this</span>.handleCurrentPetCountChange.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.handleAgeRangeSelect = <span class="keyword">this</span>.handleAgeRangeSelect.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.handlePetSelection = <span class="keyword">this</span>.handlePetSelection.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.handleSiblingsSelection = <span class="keyword">this</span>.handleSiblingsSelection.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.handleDescriptionChange = <span class="keyword">this</span>.handleDescriptionChange.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="comment">// 模拟请求用户数据</span></span><br><span class="line">    <span class="comment">//（create-react-app 构建配置里包含了 fetch 的 polyfill）</span></span><br><span class="line">    fetch(<span class="string">'./fake_db.json'</span>)</span><br><span class="line">      .then(<span class="function"><span class="params">res</span> =&gt;</span> res.json())</span><br><span class="line">      .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">          ownerName: data.ownerName,</span><br><span class="line">          petSelections: data.petSelections,</span><br><span class="line">          selectedPets: data.selectedPets,</span><br><span class="line">          ageOptions: data.ageOptions,</span><br><span class="line">          ownerAgeRangeSelection: data.ownerAgeRangeSelection,</span><br><span class="line">          siblingOptions: data.siblingOptions,</span><br><span class="line">          siblingSelection: data.siblingSelection,</span><br><span class="line">          currentPetCount: data.currentPetCount,</span><br><span class="line">          description: data.description</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  handleFullNameChange(e) &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">ownerName</span>: e.target.value &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  handleCurrentPetCountChange(e) &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">currentPetCount</span>: e.target.value &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  handleAgeRangeSelect(e) &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">ownerAgeRangeSelection</span>: e.target.value &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  handlePetSelection(e) &#123;</span><br><span class="line">    <span class="keyword">const</span> newSelection = e.target.value;</span><br><span class="line">    <span class="keyword">let</span> newSelectionArray;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.state.selectedPets.indexOf(newSelection) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">      newSelectionArray = <span class="keyword">this</span>.state.selectedPets.filter(<span class="function"><span class="params">s</span> =&gt;</span> s !== newSelection)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      newSelectionArray = [...this.state.selectedPets, newSelection];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">selectedPets</span>: newSelectionArray &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  handleSiblingsSelection(e) &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">siblingSelection</span>: [e.target.value] &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  handleDescriptionChange(e) &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">description</span>: e.target.value &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  handleClearForm(e) &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      ownerName: <span class="string">''</span>,</span><br><span class="line">      selectedPets: [],</span><br><span class="line">      ownerAgeRangeSelection: <span class="string">''</span>,</span><br><span class="line">      siblingSelection: [],</span><br><span class="line">      currentPetCount: <span class="number">0</span>,</span><br><span class="line">      description: <span class="string">''</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  handleFormSubmit(e) &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> formPayload = &#123;</span><br><span class="line">      ownerName: <span class="keyword">this</span>.state.ownerName,</span><br><span class="line">      selectedPets: <span class="keyword">this</span>.state.selectedPets,</span><br><span class="line">      ownerAgeRangeSelection: <span class="keyword">this</span>.state.ownerAgeRangeSelection,</span><br><span class="line">      siblingSelection: <span class="keyword">this</span>.state.siblingSelection,</span><br><span class="line">      currentPetCount: <span class="keyword">this</span>.state.currentPetCount,</span><br><span class="line">      description: <span class="keyword">this</span>.state.description</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Send this in a POST request:'</span>, formPayload)</span><br><span class="line">    <span class="keyword">this</span>.handleClearForm(e);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;form className=<span class="string">"container"</span> onSubmit=&#123;<span class="keyword">this</span>.handleFormSubmit&#125;&gt;</span><br><span class="line">        &lt;h5&gt;Pet Adoption Form&lt;<span class="regexp">/h5&gt;</span></span><br><span class="line"><span class="regexp">        &lt;SingleInput</span></span><br><span class="line"><span class="regexp">          inputType=&#123;'text'&#125;</span></span><br><span class="line"><span class="regexp">          title=&#123;'Full name'&#125;</span></span><br><span class="line"><span class="regexp">          name=&#123;'name'&#125;</span></span><br><span class="line"><span class="regexp">          controlFunc=&#123;this.handleFullNameChange&#125;</span></span><br><span class="line"><span class="regexp">          content=&#123;this.state.ownerName&#125;</span></span><br><span class="line"><span class="regexp">          placeholder=&#123;'Type first and last name here'&#125; /</span>&gt;</span><br><span class="line">        &lt;Select</span><br><span class="line">          name=&#123;<span class="string">'ageRange'</span>&#125;</span><br><span class="line">          placeholder=&#123;<span class="string">'Choose your age range'</span>&#125;</span><br><span class="line">          controlFunc=&#123;<span class="keyword">this</span>.handleAgeRangeSelect&#125;</span><br><span class="line">          options=&#123;<span class="keyword">this</span>.state.ageOptions&#125;</span><br><span class="line">          selectedOption=&#123;<span class="keyword">this</span>.state.ownerAgeRangeSelection&#125; /&gt;</span><br><span class="line">        &lt;CheckboxOrRadioGroup</span><br><span class="line">          title=&#123;<span class="string">'Which kinds of pets would you like to adopt?'</span>&#125;</span><br><span class="line">          setName=&#123;<span class="string">'pets'</span>&#125;</span><br><span class="line">          type=&#123;<span class="string">'checkbox'</span>&#125;</span><br><span class="line">          controlFunc=&#123;<span class="keyword">this</span>.handlePetSelection&#125;</span><br><span class="line">          options=&#123;<span class="keyword">this</span>.state.petSelections&#125;</span><br><span class="line">          selectedOptions=&#123;<span class="keyword">this</span>.state.selectedPets&#125; /&gt;</span><br><span class="line">        &lt;CheckboxOrRadioGroup</span><br><span class="line">          title=&#123;<span class="string">'Are you willing to adopt more than one pet if we have siblings for adoption?'</span>&#125;</span><br><span class="line">          setName=&#123;<span class="string">'siblings'</span>&#125;</span><br><span class="line">          controlFunc=&#123;<span class="keyword">this</span>.handleSiblingsSelection&#125;</span><br><span class="line">          type=&#123;<span class="string">'radio'</span>&#125;</span><br><span class="line">          options=&#123;<span class="keyword">this</span>.state.siblingOptions&#125;</span><br><span class="line">          selectedOptions=&#123;<span class="keyword">this</span>.state.siblingSelection&#125; /&gt;</span><br><span class="line">        &lt;SingleInput</span><br><span class="line">          inputType=&#123;<span class="string">'number'</span>&#125;</span><br><span class="line">          title=&#123;<span class="string">'How many pets do you currently own?'</span>&#125;</span><br><span class="line">          name=&#123;<span class="string">'currentPetCount'</span>&#125;</span><br><span class="line">          controlFunc=&#123;<span class="keyword">this</span>.handleCurrentPetCountChange&#125;</span><br><span class="line">          content=&#123;<span class="keyword">this</span>.state.currentPetCount&#125;</span><br><span class="line">          placeholder=&#123;<span class="string">'Enter number of current pets'</span>&#125; /&gt;</span><br><span class="line">        &lt;TextArea</span><br><span class="line">          title=&#123;<span class="string">'If you currently own pets, please write their names, breeds, and an outline of their personalities.'</span>&#125;</span><br><span class="line">          rows=&#123;<span class="number">5</span>&#125;</span><br><span class="line">          resize=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">          content=&#123;<span class="keyword">this</span>.state.description&#125;</span><br><span class="line">          name=&#123;<span class="string">'currentPetInfo'</span>&#125;</span><br><span class="line">          controlFunc=&#123;<span class="keyword">this</span>.handleDescriptionChange&#125;</span><br><span class="line">          placeholder=&#123;<span class="string">'Please be thorough in your descriptions'</span>&#125; /&gt;</span><br><span class="line">        &lt;input</span><br><span class="line">          type=<span class="string">"submit"</span></span><br><span class="line">          className=<span class="string">"btn btn-primary float-right"</span></span><br><span class="line">          value=<span class="string">"Submit"</span>/&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          className=<span class="string">"btn btn-link float-left"</span></span><br><span class="line">          onClick=&#123;<span class="keyword">this</span>.handleClearForm&#125;&gt;Clear form&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>form&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> FormContainer;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>我承认用 React 构建受控表单组件要做一些重复劳动(比如容器组件中的处理方法)，但就你对应用的掌控度和 state 变更的透明度来说，预先投入精力是超值的。你的代码会变得可维护并且很高效。</p>
<p>如果想在我发布新文章时接到通知，你可以在<a href="http://lorenstewart.me" target="_blank" rel="noopener">博客</a>的导航栏部分注册我的邮件发送清单。</p>
<ul>
<li>原文地址：<a href="http://lorenstewart.me/2016/10/31/react-js-forms-controlled-components/" target="_blank" rel="noopener">React.js Forms: Controlled Components</a></li>
<li>原文作者：<a href="http://lorenstewart.me/author/lorenseanstewart/" target="_blank" rel="noopener">Loren Stewart</a></li>
<li>译者：<a href="http://pobusama.github.io/about/" target="_blank" rel="noopener">小 B0Y</a></li>
<li>校对者：<a href="https://github.com/cfanlife" target="_blank" rel="noopener">珂珂君</a> </li>
</ul>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2017-07-30</span><i class="fa fa-tag"></i><a class="tag" href="/categories/技术/" title="技术">技术 </a><a class="tag" href="/tags/React/" title="React">React </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" href="http://twitter.com/home?status=,http://yoursite.com/2017/07/30/react-forms-controlled-components/,COOK LIFE,翻译 | 玩转 React 表单 —— 受控组件详解,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2017/09/03/createStore/" title="【话说 Redux 源码（一）】createStore —— 繁华的起点">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2017/04/15/a-detail-introduction-to-webpack/" title="翻译|上手 Webpack ? 这篇就够了！">下一篇</a></li></ul></div><a id="comments"></a><div id="vcomments" style="margin:0 30px;"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/gh/xcss/valine@v1.1.7/dist/Valine.min.js?v=undefined"></script><script>var valine = new Valine({
  el:'#vcomments',
  notify:true || false, 
  verify:true|| false, 
  app_id:'vPjtr6BKvaz821se9iFDov9m-gzGzoHsz',
  app_key:'nUoDbTcWFKDvvz7r5xPDVwON',
  placeholder:'Just go go',
  path: window.location.pathname,
  avatar:'mm'
})</script></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>